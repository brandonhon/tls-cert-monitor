# TLS Certificate Monitor Configuration - Windows
# Generated by Ansible

# Certificate directories to scan
certificates:
  directories:
{% for dir in cert_dirs_windows %}
    - "{{ dir }}"
{% endfor %}

  # Exclude patterns
  exclude_patterns:
    - "*.bak"
    - "*.old"
    - "*.tmp"
    - "*\\backup\\*"

  # P12/PFX passwords
  p12_passwords:
    - ""  # Try empty password first
    - "changeit"
    - "password"

# Scan configuration
scan:
  interval_seconds: {{ scan_interval_seconds }}
  workers: {{ scan_workers }}
  recursive: true
  follow_symlinks: false

# Server configuration
server:
  host: "0.0.0.0"
  port: {{ service_port }}

  # TLS configuration (optional)
  tls:
    enabled: false
    cert_file: ""
    key_file: ""

# Cache configuration
cache:
  enabled: {{ enable_cache | lower }}
  ttl_seconds: {{ cache_ttl_seconds }}
  max_size: 1000
  directory: "{{ config_dir_windows }}\\cache"

# Logging configuration
logging:
  level: "{{ log_level }}"
  format: "json"
  file: "{{ log_dir_windows }}\\tls-cert-monitor.log"
  max_size_mb: 100
  max_backups: 5
  max_age_days: 30

# Feature flags
features:
  hot_reload: {{ enable_hot_reload | lower }}
  dry_run: false
  enable_profiling: false

# Alert thresholds
alerts:
  expiry_warning_days: 30
  expiry_critical_days: 7
  weak_key_bits: 2048

# Metrics configuration
metrics:
  include_file_paths: true
  include_issuer_info: true
  include_san_info: true