# TLS Certificate Monitor Configuration

# Server settings
port: 3200
bind_address: "0.0.0.0"

# TLS settings for metrics endpoint (optional)
# tls_cert: "/path/to/server.crt"
# tls_key: "/path/to/server.key"

# Certificate monitoring
certificate_directories:
  - "/etc/ssl/certs"
  - "/etc/pki/tls/certs"
  # Add more directories as needed

# Directories to exclude from scanning (optional)
# These paths will be skipped even if they are within certificate_directories
exclude_directories:
  - "/etc/ssl/certs/private"
  - "/etc/ssl/certs/backup"
  - "/etc/pki/tls/certs/archived"
  # Add directories you want to exclude from certificate scanning

# File patterns to exclude from scanning (optional)
# These are regex patterns that will exclude files by name
exclude_file_patterns:
  - "dhparam.pem"        # Exclude Diffie-Hellman parameter files
  - ".*\\.key$"         # Exclude private key files
  - ".*backup.*"        # Exclude backup files
  # Add regex patterns for files you want to exclude

# P12/PFX certificate passwords
# List of passwords to try when decrypting P12/PFX certificate files
# Common passwords are included by default, add your specific ones here
p12_passwords:
  - ""                    # Empty password (no password)
  - "changeit"           # Java keystore default
  - "password"           # Common default
  - "123456"             # Common weak password
  # Add your organization-specific P12 passwords here
  # - "your-p12-password"
  # - "another-password"

# Scan interval (how often to scan for certificates)
scan_interval: "5m"

# Performance settings
workers: 4

# Logging
log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
# log_file: "/var/log/tls-monitor.log"  # If not set, logs to stdout

# Operation modes
dry_run: false
hot_reload: true

# Cache settings
cache_type: "memory"       # "memory", "file", or "both"
cache_dir: "./cache"       # Only used when cache_type is "file" or "both"
cache_ttl: "1h"
cache_max_size: 10485760   # 10MB (memory), use 31457280 for file cache (30MB)

# Security settings
enable_ip_whitelist: true  # Enable IP address whitelisting for API access
allowed_ips:
  - "127.0.0.1"           # Localhost IPv4
  - "::1"                 # Localhost IPv6
  - "192.168.1.0/24"      # Local network (CIDR notation)
  # Add your specific IP addresses or networks here:
  # - "10.0.0.0/8"        # Private network range
  # - "172.16.0.100"      # Specific server IP
  # - "203.0.113.0/24"    # Public network range